<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>不想记账-全世界最好的记账工具</title>
    <meta name="description" content="不想记账，天坑自救小组专业团队开发，为您提供最好的记账服务
    功能囊括注册、登录、选择账本、记录账目、修改账目、删除账目、修改用户名、注销登录等">
    <meta name="keywords" content="不想记账，记账，在线服务，云端存储">
    <link rel="icon" href="favicon.ico" sizes="50x50">
    <link rel="stylesheet" href="./css/base.css">
    <link rel="stylesheet" href="./css/login.css">
</head>
<body>
<div class="w">
    <div class="head">
        <h1>不想记账</h1>
        <img src="./img/avatar.png" alt="不想记账LOGO">
        <p>全世界最具影响力的在线记账网站</p>
    </div>
    <div class="formArea">
        <p>请登录</p>
        <form>
            <input type="text" name="username" placeholder="用户名" id="username" autocomplete='username'>
            <br>
            <input type="password" name="password" placeholder="密码" id="password" autocomplete='new-password'>
            <p>忘记密码</p>
            <!--                <input type="submit" class="submit" value="登录" onclick=resAJAXPost()>-->
            <div class="submit" onclick="resAJAXPost()">登录</div>
            <p>注册账户</p>
        </form>
    </div>
</div>
<!--<script type="text/javascript" src="./js/login.js"></script>-->
<script>
    var xmlHttp = new XMLHttpRequest();

    //POST
    function sendAJAXPost(callback) {
        let inputName = document.getElementById("username")
        let username = inputName.value
        let inputPassword = document.getElementById("password")
        let password = inputPassword.value

        xmlHttp.onreadystatechange = callback;
        xmlHttp.open("POST", "/user/login");
        xmlHttp.setRequestHeader("Content-type", "application/json;charset=UTF-8");
        xmlHttp.send(JSON.stringify({"username": username, "password":password}));
    }

    function resAJAXPost() {
        sendAJAXPost(function () {
            if (xmlHttp.readyState === 4 && xmlHttp.status === 200) {
                var res = JSON.parse(xmlHttp.responseText);
                if (res.code === 1) {
                    window.location.href = './index.html'
                } else {
                    window.alert("账号或密码错误")
                }
            }
        })
    }
</script>

</body>
</html>